<div class="container mt-3">
  <div class="row justify-content-center">
    <div class="col-xs-12 col-sm-8 col-lg-6">
      <h2 class="text-center mb-3">Booking #<%= @booking.id %> <small><span class="badge badge-primary"><%= @booking.state %></span></small></h2>
      <p>On <%= @booking.start_time.strftime("%a, %e %b %Y") %>,
        at <%= @booking.start_time.strftime("%H:%M") %> for <%= "#{@booking.length}mins" %>.
        Doctor: <%= @doctor.first_name %>,
        Patient: <%= @patient.first_name %>
        (<%= @booking.status %>)
      </p>
      <div class="list-group">
        <% @booking.booking_services.each do |booking_service| %>
          <div class="list-group-item list-group-item-action"><%= booking_service.service.name %></div>
        <% end %>
      </div>
      <br>
        <!-- <ul class="list-unstyled">
          <li><strong>ISSUED ON:</strong> <%#= @booking.created_at.to_date %></li>
          <li><strong>SERVICE:</strong> <%#= @booking.services.first.name %></li>
          <li><strong>TOTAL:</strong> <%#= humanized_money_with_symbol @booking.amount %></li>
          </li>
        </ul>
      <br> -->
      <div>
        <% if policy(User).doctor? %>
          <% if @booking.note %>
            <h5>Clinical Notes
              <% if policy(@booking.note).edit? %>
                <%= link_to edit_note_path(@booking.note) do %>
                  <i class="far fa-edit"></i>
                <% end %>
              <% end %>
              <% if policy(@booking.note).destroy? %>
                <%= link_to note_path(@booking.note), method: :delete, data: { confirm: "Are you sure?" } do %>
                  <i class="far fa-trash-alt"></i>
                <% end %>
              <% end %>
            </h5>
            <p><%= @booking.note.note %></p>
          <% else %>
            <%= simple_form_for([@booking, @note], remote: true) do |f| %>
              <%= f.input :note, label: "Notes" %>
              <%= f.submit "Add Notes", class: "btn btn-primary w-100 mb-3" %>
            <% end %>
          <% end %>

          <% if @booking.amount != 0 %>
            <h5>Payment</h5>
            <p><%= humanized_money_with_symbol(@booking.amount) %></p>
          <% else %>
            <%= simple_form_for(@booking, url: update_amount_booking_path(@booking), remote: true) do |f| %>
              <%= f.input :amount, label: "Payment" %>
              <%= f.submit "Add Payment", class: "btn btn-primary w-100 mb-3" %>
            <% end %>
          <% end %>
        <% end %>
      </div>
      <br>
      <%= link_to "List", bookings_path %>
      <% if policy(@booking).edit? %>
        <%= link_to edit_booking_path(@booking) do %>
          <i class="far fa-edit"></i>
        <% end %>
      <% end %>
      <% if policy(@booking).destroy? %>
        <%= link_to booking_path(@booking), method: :delete, data: { confirm: "Are you sure?" } do %>
          <i class="far fa-trash-alt"></i>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
